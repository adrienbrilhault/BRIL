<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bootstrap and Refine Iterative Locator — bril • BRIL</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bootstrap and Refine Iterative Locator — bril" />
<meta property="og:description" content="Robust Estimate of Mode in Multivariate Distribution" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-200250973-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-200250973-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRIL</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Notebooks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/demo_ArtificialData.html">Demo Artificial Data</a>
    </li>
    <li>
      <a href="../articles/demo_EyeTrackingData.html">Demo Eye-tracking Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adrienbrilhault/BRIL/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap and Refine Iterative Locator</h1>
    <small class="dont-index">Source: <a href='https://github.com/adrienbrilhault/BRIL/blob/master/pkg/R/bril.R'><code>R/bril.R</code></a></small>
    <div class="hidden name"><code>bril.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Robust Estimate of Mode in Multivariate Distribution</p>
    </div>

    <pre class="usage"><span class='fu'>bril</span><span class='op'>(</span>
  <span class='va'>data</span>,
  maxIterations <span class='op'>=</span> <span class='cn'>NULL</span>,
  minUnassigned <span class='op'>=</span> <span class='fl'>0.1</span>,
  method <span class='op'>=</span> <span class='st'>"Projection"</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.5</span>,
  testUnimodal <span class='op'>=</span> <span class='st'>"DIP"</span>,
  threshUnimodal <span class='op'>=</span> <span class='fl'>0.05</span>,
  distUnimodal <span class='op'>=</span> <span class='st'>"Euclidean"</span>,
  testNormal <span class='op'>=</span> <span class='st'>"Mardia"</span>,
  threshNormal <span class='op'>=</span> <span class='fl'>0.05</span>,
  distNormal <span class='op'>=</span> <span class='st'>"MCD"</span>,
  trimmedPerFilteringIteration <span class='op'>=</span> <span class='fl'>1</span>,
  exitWhenUnimodal <span class='op'>=</span> <span class='cn'>FALSE</span>,
  debug <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warnings <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Matrix of numerical values containing the observations (one per
row, with two columns for X and Y coordinates)</p></td>
    </tr>
    <tr>
      <th>maxIterations</th>
      <td><p>Maximum number of iterations performed by the algorithm
(set to NULL or 0 for unlimited number)</p></td>
    </tr>
    <tr>
      <th>minUnassigned</th>
      <td><p>Numerical value between 0 and 1 (default: 0.1),
providing the proportion of unassigned samples from <code>data</code> below which the
algorithm will terminate</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method to use. Valid options are "MCD" and "MVE" for convex
body minimizers, or "L2", "Lui", "Mahalanobis", "Oja", "Projection"
(default), "Spatial" and "Tukey" for depth functions</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Proportion of samples trimmed at each iteration of the recursive
median estimate (numerical value between 0 and 1, default: 0.5), see
<code><a href='median_rec.html'>median_rec()</a></code></p></td>
    </tr>
    <tr>
      <th>testUnimodal</th>
      <td><p>Statistical test used for unimodality. Valid options are
"DIP" only, see <code><a href='filter_outliers.html'>filter_outliers()</a></code></p></td>
    </tr>
    <tr>
      <th>threshUnimodal</th>
      <td><p>Threshold of significance for the unimodality test
(numerical value between 0 and 1, default: 0.05)</p></td>
    </tr>
    <tr>
      <th>distUnimodal</th>
      <td><p>Distance metric used for ordering the samples in the
unimodal filtering. Valid options are "Euclidean" (default), or "MCD",
"MVE", and "OGK" for robust distances. "Euclidean" is strongly advised for
unimodality tests.</p></td>
    </tr>
    <tr>
      <th>testNormal</th>
      <td><p>Statistical test used for normality. Valid options are
"Mardia" (default), "Kurtosis", "Skewness", "KS", "KS-adj", "Shapiro",
"Lillie" and "Chisq", see <code><a href='filter_outliers.html'>filter_outliers()</a></code></p></td>
    </tr>
    <tr>
      <th>threshNormal</th>
      <td><p>Threshold of significance for the normality test
(numerical value between 0 and 1, default: 0.05)</p></td>
    </tr>
    <tr>
      <th>distNormal</th>
      <td><p>Distance metric used for ordering the samples in the normal
filtering. Valid options are "Euclidean", or "MCD" (default), "MVE", and
"OGK" for robust distances. Robust distances are strongly advised for
normality tests.</p></td>
    </tr>
    <tr>
      <th>trimmedPerFilteringIteration</th>
      <td><p>Number of samples trimmed at each
iteration of the unimodality and normality filtering (default: 1), see
<code><a href='filter_outliers.html'>filter_outliers()</a></code></p></td>
    </tr>
    <tr>
      <th>exitWhenUnimodal</th>
      <td><p>Logical value. <code>TRUE</code> will terminate the execution of
the algorithm as soon as an unimodal subset is encountered on the start of
a global iteration. <code>FALSE</code> (default) will let that last iteration proceed
before terminating</p></td>
    </tr>
    <tr>
      <th>debug</th>
      <td><p>Logical value. <code>TRUE</code> will compute all p.values in the filtering
steps (even after they exceed the selection threshold, see
<code><a href='plot.BRIL.Filtering.html'>plot.BRIL.Filtering()</a></code>)</p></td>
    </tr>
    <tr>
      <th>warnings</th>
      <td><p>Logical value, to display the warnings and errors caught</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an S3 object of type <code>BRIL</code> containing the
following values:</p>
<dt><code>call</code></dt><dd><p>Parameters of the call (contains <code>data</code>, <code>maxIterations</code>,
<code>minUnassigned</code>, <code>method</code>, <code>alpha</code>, <code>testUnimodal</code>, <code>threshUnimodal</code>,
<code>distUnimodal</code>, <code>testNormal</code>, <code>threshNormal</code>, <code>distNormal</code>,
<code>trimmedPerFilteringIteration</code>, and <code>exitWhenUnimodal</code>)</p></dd>
<dt><code>iterations</code></dt><dd><p>A list with every global iteration of the algorithm,
each containing the two filtering procedures performed: <code>filteringUnimodal</code>
and <code>filteringNormal</code> (both being S3 object of class <code>BRIL.Filtering</code>, see
<code><a href='filter_outliers.html'>filter_outliers()</a></code>)</p></dd>
<dt><code>nbClusters</code></dt><dd><p>Number of groups encountered</p></dd>
<dt><code>labels</code></dt><dd><p>Labels of the groups encountered (corresponding to the
number of the iteration they were identified in)</p></dd>
<dt><code>clustersCenters</code></dt><dd><p>Matrix containing the coordinates of the centers
of each group (row-wise)</p></dd>
<dt><code>clustersSizes</code></dt><dd><p>Array with the number of samples in each group</p></dd>
<dt><code>mainCluster</code></dt><dd><p>Index of the group identified as main mode</p></dd>
<dt><code>mode</code></dt><dd><p>Coordinates of the main mode</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.BRIL.html'>plot.BRIL()</a></code>, <code><a href='print.BRIL.html'>print.BRIL()</a></code>, <code><a href='filter_outliers.html'>filter_outliers()</a></code>, <code><a href='median_rec.html'>median_rec()</a></code>,
<code><a href='median_mv.html'>median_mv()</a></code>, <code><a href='depth_values.html'>depth_values()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Create a sample distribution and run bril() function</span>
<span class='va'>XY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span>
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>15</span>, <span class='fl'>20</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>, <span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>0.5</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>200</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>bril</span><span class='op'>(</span><span class='va'>XY</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; =&gt; Results for bril() using method "Projection" (alpha=0.5), DIP Unimodality Test (&gt; 0.05), and Mardia Normality test (&gt; 0.05)
#&gt;    750 samples: 3 clusters identified (sizes 311, 157, 106), and 176 samples unassigned
#&gt; 
#&gt; Mode:
#&gt; [1]  0.2010784 -0.0902806
#&gt; 
#&gt; 
#&gt; Clusters Sizes:
#&gt; [1] 311 157 106
#&gt; 
#&gt; 
#&gt; Clusters Centers:
#&gt;            [,1]       [,2]
#&gt; [1,]  0.2010784 -0.0902806
#&gt; [2,] -9.8754989 15.0017539
#&gt; [3,] 15.0520460 19.9446651
#&gt; 
#&gt; 
#&gt; Labels:
#&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; [223] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; [260] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; [297] 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
#&gt; [334] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
#&gt; [371] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 2 2
#&gt; [408] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
#&gt; [445] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
#&gt; [482] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2 2 2 2 2 2 2
#&gt; [519] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0
#&gt; [556] 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1
#&gt; [593] 3 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 3 0 0 0 0 0 0 0 0 2
#&gt; [630] 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2
#&gt; [667] 1 0 0 1 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 2 0 2 0 0 0 0 0 0 0 0 3 0 0 0 0
#&gt; [704] 0 0 0 2 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 2 0 0 0 0 0 0 0 0 0
#&gt; [741] 0 0 2 0 0 0 0 0 3 0
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># Plot the mode and groups encountered</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='img'><img src='bril-1.svg' alt='' width='701' height='701' /></div><div class='input'>
<span class='co'># Plot the different iterations (interactive)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span>, contents <span class='op'>=</span> <span class='st'>"iterations"</span>, asp <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># See ?plot.BRIL() for other plotting examples</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.linkedin.com/in/adrienbrilhault/'>Adrien Brilhault</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


