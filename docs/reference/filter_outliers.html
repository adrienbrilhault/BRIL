<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Recursive outlier filtering based on robust distances and multinormality
tests — filter_outliers • BRIL</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Recursive outlier filtering based on robust distances and multinormality
tests — filter_outliers" />
<meta property="og:description" content="Recursive outlier filtering based on robust distances and multinormality
tests" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-200250973-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-200250973-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BRIL</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Notebooks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/demo_ArtificialData.html">Demo Artificial Data</a>
    </li>
    <li>
      <a href="../articles/demo_EyeTrackingData.html">Demo Eye-tracking Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adrienbrilhault/BRIL/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Recursive outlier filtering based on robust distances and multinormality
tests</h1>
    <small class="dont-index">Source: <a href='https://github.com/adrienbrilhault/BRIL/blob/master/pkg/R/filter_outliers.R'><code>R/filter_outliers.R</code></a></small>
    <div class="hidden name"><code>filter_outliers.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Recursive outlier filtering based on robust distances and multinormality
tests</p>
    </div>

    <pre class="usage"><span class='fu'>filter_outliers</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>center</span>,
  test <span class='op'>=</span> <span class='st'>"Mardia"</span>,
  threshold <span class='op'>=</span> <span class='fl'>0.05</span>,
  <span class='va'>distType</span>,
  trimmedPerIteration <span class='op'>=</span> <span class='fl'>1</span>,
  debug <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warnings <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Matrix of numerical values containing the observations (one per
row, with two columns for X and Y coordinates)</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>Coordinates used to computes the distances of the samples and
order them (array of numerical two values, for X and Y)</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>Statistical test to use. Valid options are "DIP" for unimodality
test, or "Mardia", "Kurtosis", "Skewness", "KS", "KS-adj", "Shapiro",
"Lillie", and "Chisq" for multivariate normality test</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Threshold of significance for the statistical test (between
0 and 1, default: 0.05)</p></td>
    </tr>
    <tr>
      <th>distType</th>
      <td><p>Distance metric used to order the samples. Valid options are
"Euclidean", "MCD", "MVE", and "OGK". If empty or NULL, "Euclidean" will be
automatically selected for unimodality tests, and "MCD" for normality
tests</p></td>
    </tr>
    <tr>
      <th>trimmedPerIteration</th>
      <td><p>Number of samples trimmed at each iteration
(positive integer, default: 1)</p></td>
    </tr>
    <tr>
      <th>debug</th>
      <td><p>Logical value. <code>TRUE</code> will compute all p.values, even after
exceeding the threshold, for plotting purpose (see <code><a href='plot.BRIL.Filtering.html'>plot.BRIL.Filtering()</a></code>)</p></td>
    </tr>
    <tr>
      <th>warnings</th>
      <td><p>Logical value, to display the warnings and errors caught</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an S3 object of type <code>BRIL.Filtering</code>
containing the following values:</p>
<dt><code>call</code></dt><dd><p>Parameters of the call (contains <code>data</code>, <code>test</code>,
<code>testType</code>, <code>center</code>, <code>threshold</code>, <code>trimmedPerIteration</code> and <code>distType</code>)</p></dd>
<dt><code>distances</code></dt><dd><p>Distances of each sample from <code>data</code> to the <code>center</code>
provided</p></dd>
<dt><code>p.values</code></dt><dd><p>P.Values of the test at each iteration</p></dd>
<dt><code>index.p.values</code></dt><dd><p>Subset size corresponding to each P.Value, for
plotting purpose</p></dd>
<dt><code>selected</code></dt><dd><p>Indices of the samples from <code>data</code> selected at the end of
the filtering</p></dd>
<dt><code>cutoffDistance</code></dt><dd><p>Distance of the furthest inlier selected</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For unimodality tests parameter <code>distType</code> should be set to
"Euclidean" (as the distribution might contains a large amount of
outliers). For normality tests robust distances are preferable, using a
robust estimate estimates of location and scatter ("MCD","MVE", or "OGK").</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plot.BRIL.Filtering.html'>plot.BRIL.Filtering()</a></code>, <code><a href='print.BRIL.Filtering.html'>print.BRIL.Filtering()</a></code>, <code><a href='bril.html'>bril()</a></code>,
<code><a href='median_rec.html'>median_rec()</a></code>, <code><a href='median_mv.html'>median_mv()</a></code>, <code><a href='depth_values.html'>depth_values()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Example 1</span>

<span class='co'># Illustrative data</span>
<span class='va'>XY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span>
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>3</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>15</span>, <span class='fl'>20</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>, <span class='fl'>15</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>-</span> <span class='fl'>0.5</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>200</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Compute an estimate for the center</span>
<span class='va'>center</span> <span class='op'>&lt;-</span> <span class='fu'><a href='median_rec.html'>median_rec</a></span><span class='op'>(</span><span class='va'>XY</span><span class='op'>)</span><span class='op'>$</span><span class='va'>median</span>

<span class='co'># Remove non unimodal outliers from this location</span>
<span class='va'>filtering</span> <span class='op'>&lt;-</span> <span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>XY</span>, <span class='va'>center</span>, test <span class='op'>=</span> <span class='st'>"DIP"</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>filtering</span>, maxDisplayed <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; =&gt; Results for filter_outlier() using DIP Unimodality Test (p.value &gt; 0.05) and Euclidean Distances
#&gt;    750 samples: 412 selected, 338 filtered (1 trimmed per iteration)
#&gt; 
#&gt; Selected indices:
#&gt;   [1] 130   3 165 114 196 221  59 261 195 145 274 250 191   2  30 213  76 244
#&gt;  [19]   6 170  68  42 290 142 134 218  31 149 297 264  48 120  50  64  45 192
#&gt;  [37] 293 270  90 271  26 236 282 126 210 257  74  37   5  15  33 184 143  75
#&gt;  [55] 292 181 256  98  88   4 129 146 220 289 225 272  58 127 246  18  97 159
#&gt;  [73] 279 137 212  24  12 207 216 147 118 275  53 105 287 263  23  20 131 268
#&gt;  [91] 204 227 133  38  84  17 197 101  44 269 132 278 166  86 248 156 180  93
#&gt; [109] 115 222  32 251  78 119  69 155 237  99 234 198 102 148 255 189 232 262
#&gt; [127]   8 110 300 171 112 187 138 228 277 215 186 121 177 219  80 144 209 233
#&gt; [145]  67  73  39 286  83 193 160 249 201  51 151  49 199 240 107 109 153  35
#&gt; [163] 214  71 173  22   9 245 223 205  28  70  61 163 273  72 231   7  89 294
#&gt; [181] 288 136  63  66 135 122 259  34 128 238 106  56 116  13 267 175 185  82
#&gt; [199]  46 161
#&gt;  ... (212 hidden)
#&gt; 
#&gt; DIP Test p.values:
#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt;  [75] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt;  ... (548 hidden)
#&gt; 
#&gt; Outliers cutoff distance from center (0.393423166296777, 0.233469428446786):
#&gt; [1] 16.46958
#&gt; 
#&gt; 
#&gt; Euclidean Distances:
#&gt;   [1] 2.52752705 0.44643527 0.08971618 0.85489275 0.75458482 0.52996150
#&gt;   [7] 2.00880037 1.58182856 1.89858558 2.85938447 2.44638408 1.03441922
#&gt;  [13] 2.14116411 3.58999579 0.76953186 2.57291716 1.20796330 0.95364614
#&gt;  [19] 2.98491778 1.15987201 3.06801663 1.88209200 1.11317735 1.03312562
#&gt;  [25] 2.68712337 0.70804074 2.72055542 1.96084178 3.30307965 0.45034359
#&gt;  [31] 0.65321695 1.40074900 0.78753487 2.10208262 1.86127595 3.21688149
#&gt;  [37] 0.74964996 1.19948317 1.72009709 4.76284015 2.81784620 0.61208015
#&gt;  [43] 2.56531392 1.22024795 0.68967873 2.18090494 4.41948304 0.66051720
#&gt;  [49] 1.80731867 0.67448299 1.76915661 2.45767812 1.08823556 2.41920277
#&gt;  [55] 2.90928051 2.12482753 2.26947312 0.92452742 0.31956336 3.49778474
#&gt;  [61] 1.96282881 2.45884702 2.06119435 0.68049274 2.51554430 2.06587450
#&gt;  [67] 1.71392831 0.57829632 1.43331681 1.96270675 1.86392667 1.97725288
#&gt;  [73] 1.71430750 0.74639445 0.80601492 0.47901863 2.56203302 1.42762255
#&gt;  [79] 4.44925730 1.68194906 2.92632295 2.16839824 1.73386071 1.20635752
#&gt;  [85] 3.50396937 1.31271538 3.13569270 0.85471829 2.03317347 0.69493141
#&gt;  [91] 2.65673941 2.46852570 1.34611810 3.50389876 3.13136724 2.45308544
#&gt;  [97] 0.98200234 0.84935290 1.46657654 3.44510267 1.21791904 1.47353029
#&gt; [103] 2.35584926 3.95063593 1.08967680 2.12022173 1.83757857 2.61002662
#&gt; [109] 1.85245521 1.58470768 2.42034441 1.61062318 3.18570933 0.20057720
#&gt; [115] 1.35695698 2.12834647 2.91860024 1.06974978 1.43035664 0.66969390
#&gt; [121] 1.66255945 2.08672152 2.43556743 2.52421711 2.77370060 0.72521705
#&gt; [127] 0.94229216 2.10353202 0.85815116 0.04017239 1.16535163 1.26169686
#&gt; [133] 1.18979950 0.63510019 2.08083508 2.06052631 0.99180176 1.62584246
#&gt; [139] 3.26399709 2.45563775 2.50738268 0.62944541 0.80411478 1.68804957
#&gt; [145] 0.33491001 0.87889320 1.05789210 1.47735877 0.65640613 3.33175869
#&gt; [151] 1.77858854 5.16524164 1.85358741 4.93119545 1.43555002 1.31863194
#&gt; [157] 2.58554077 2.64216945 0.98583766 1.74533691 2.20149820 2.21713305
#&gt; [163] 1.96672549 3.56783153 0.10185247 1.29801954 2.99758908 2.38753873
#&gt; [169] 2.32226355 0.54511183 1.60875754 3.59783695 1.87102392 3.81606093
#&gt; [175] 2.15913404 2.31888579 1.66922692 2.22998814 2.26641096 1.34472348
#&gt; [181] 0.81808998 2.25403096 2.46254978 0.80349374 2.16088017 1.65919317
#&gt; [187] 1.61927894 3.06058162 1.55682378 3.18940494 0.41203180 0.69187025
#&gt; [193] 1.74064553 4.43400791 0.33253210 0.23039279 1.21076605 1.47097893
#&gt; [199] 1.81169212 3.12903242
#&gt;  ... (550 hidden)
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>filtering</span><span class='op'>)</span>
</div><div class='img'><img src='filter_outliers-1.svg' alt='' width='701' height='701' /></div><div class='input'>
<span class='co'>## Example 2</span>

<span class='co'># Illustrative data</span>
<span class='va'>XY</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span>
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='fl'>1.5</span><span class='op'>)</span>,
  <span class='fu'>mvtnorm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span><span class='op'>(</span><span class='fl'>150</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>400</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># Compute an estimate for the center</span>
<span class='va'>center</span> <span class='op'>&lt;-</span> <span class='fu'><a href='median_rec.html'>median_rec</a></span><span class='op'>(</span><span class='va'>XY</span><span class='op'>)</span><span class='op'>$</span><span class='va'>median</span>

<span class='co'># Remove non normal outliers from this location</span>
<span class='va'>filtering</span> <span class='op'>&lt;-</span> <span class='fu'>filter_outliers</span><span class='op'>(</span><span class='va'>XY</span>, <span class='va'>center</span>, test <span class='op'>=</span> <span class='st'>"Chisq"</span>, distType <span class='op'>=</span> <span class='st'>"MVE"</span>, debug <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>filtering</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; =&gt; Results for filter_outlier() using Chisq Normality Test (p.value &gt; 0.05) and MVE-based Robust Distances
#&gt;    450 samples: 314 selected, 136 filtered (1 trimmed per iteration)
#&gt; 
#&gt; Selected indices:
#&gt;   [1] 256  18   6 182 128 232  19  55 178 138 281 186  77 294  71 274 153  40
#&gt;  [19] 230 226  22 223 213 248  59  91 215 231 202 267 253 129 227 154 134 105
#&gt;  [37] 198 181 185  51 272 172 279 217  13 206 222  38  73 139 140 251  50 177
#&gt;  [55] 200 125 156  54 240  27  81 175   8   4 289 143 239 113 292  68  61 147
#&gt;  [73] 108 235 207  29  87 164 288 155  85 106 271  34 112  80 257  84  16 273
#&gt;  [91] 184  76 176  95  42  89 103 219 115  10 233 204 286 297 127 255 179  88
#&gt; [109]  52  31 208 269 158 118 252 290 100 142 220 211 121  23  96 160 247 264
#&gt; [127] 102  30  65  67 259 241 190 171 110   9  62 126  47  98 209 152 193  15
#&gt; [145] 145 194 170 167 265  45 218 107 168  94 117  60 277 201  39 245 197 191
#&gt; [163] 237 183 225 210  70 249 270 262  41 296 246   1 278 196  86  14 116 130
#&gt; [181]  43  36 275 101 221 212  57 254 144 260 149 111 162 109 280 284 150 214
#&gt; [199]  74 291
#&gt;  ... (114 hidden)
#&gt; 
#&gt; CHISQ Test p.values:
#&gt;   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;   [6] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [11] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [16] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [21] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [26] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [31] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [36] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [41] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [46] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [51] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [56] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [61] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [66] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [71] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [76] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [81] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [86] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [91] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt;  [96] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [101] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [106] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [111] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [116] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [121] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00
#&gt; [126] 1.110223e-16 3.119727e-14 7.159939e-12 5.130705e-10 2.036797e-08
#&gt; [131] 6.768378e-07 5.576854e-06 7.019705e-05 3.686624e-04 1.700960e-03
#&gt; [136] 1.388550e-02 5.033845e-02 7.348920e-02 1.749051e-01 2.912747e-01
#&gt; [141] 5.035028e-01 6.181522e-01 7.449625e-01 9.435373e-01 8.613966e-01
#&gt; [146] 6.741954e-01 4.460517e-01 3.689139e-01 2.844887e-01 2.244801e-01
#&gt; [151] 1.877329e-01 1.527039e-01 1.401063e-01 1.231341e-01 1.000219e-01
#&gt; [156] 1.053560e-01 8.624022e-02 8.181969e-02 7.063474e-02 6.960468e-02
#&gt; [161] 5.930115e-02 5.149199e-02 5.288296e-02 4.114576e-02 3.702522e-02
#&gt; [166] 4.170168e-02 2.977518e-02 3.328082e-02 2.787891e-02 3.160317e-02
#&gt; [171] 2.795433e-02 2.209852e-02 2.198374e-02 1.229999e-02 1.240659e-02
#&gt; [176] 1.336821e-02 1.096335e-02 1.017930e-02 1.186412e-02 1.188425e-02
#&gt; [181] 7.010764e-03 4.436453e-03 5.023400e-03 3.763533e-03 3.728587e-03
#&gt; [186] 2.930228e-03 3.680144e-03 3.096428e-03 2.781557e-03 2.036123e-03
#&gt; [191] 2.187177e-03 2.224476e-03 1.857228e-03 1.672501e-03 1.669372e-03
#&gt; [196] 1.654429e-03 1.423347e-03 1.315488e-03 1.241916e-03 1.282204e-03
#&gt;  ... (248 hidden)
#&gt; 
#&gt; Outliers cutoff distance from center (-0.128585197619999, 0.523583892516997):
#&gt; [1] 5.406487
#&gt; 
#&gt; 
#&gt; MVE-based Robust Distances:
#&gt;   [1] 1.30573700 1.49606293 2.13644006 0.73445558 1.85455385 0.08537408
#&gt;   [7] 3.04407638 0.73161243 1.12387981 0.93586151 1.72366368 2.60537867
#&gt;  [13] 0.57153337 1.35309701 1.15290275 0.89818697 1.53402903 0.04583873
#&gt;  [19] 0.15457869 2.45875349 1.70811264 0.37350715 1.04022263 1.88227572
#&gt;  [25] 1.82273270 1.70978038 0.70846687 2.19338755 0.82127999 1.09228641
#&gt;  [31] 0.98016638 2.44356948 1.79078038 0.87706979 2.21718780 1.37609126
#&gt;  [37] 1.64609442 0.61279997 1.25573529 0.34778528 1.30375682 0.92407178
#&gt;  [43] 1.37567656 2.04394769 1.18164705 1.96745213 1.12666204 1.69475184
#&gt;  [49] 2.40326564 0.66705298 0.54038416 0.97838981 1.95836144 0.70377528
#&gt;  [55] 0.15587076 1.61895189 1.40739938 1.49860521 0.39310348 1.23522714
#&gt;  [61] 0.78325010 1.12427372 1.91490141 1.69014991 1.09826782 1.63675540
#&gt;  [67] 1.10580681 0.78212126 1.66410075 1.30101212 0.31301225 2.49341167
#&gt;  [73] 0.61822154 1.47543053 1.49066858 0.90887869 0.28536091 2.16462224
#&gt;  [79] 2.22269389 0.88845206 0.71211594 1.84167956 2.34780306 0.89209072
#&gt;  [85] 0.86040768 1.33428797 0.82232815 0.97783742 0.92524773 2.02124342
#&gt;  [91] 0.41019252 1.64607455 1.83621410 1.22616481 0.91848552 1.04924082
#&gt;  [97] 2.31965346 1.13056203 1.83258087 1.01652480 1.39020220 1.08065401
#&gt; [103] 0.92657530 3.49656343 0.48385870 0.87104858 1.21186160 0.79223770
#&gt; [109] 1.46207434 1.11796261 1.43855069 0.88359153 0.75900467 1.78639454
#&gt; [115] 0.92941020 1.35662086 1.23066322 0.99878294 2.01555373 1.83263929
#&gt; [121] 1.03404383 2.05899300 1.62364061 1.50844779 0.67450442 1.12482287
#&gt; [127] 0.95517203 0.13781445 0.44853663 1.37200529 1.90599719 2.34351564
#&gt; [133] 2.29155679 0.47514665 1.95338858 1.70520191 1.80624776 0.19259103
#&gt; [139] 0.62226761 0.64195337 2.89570562 1.02899315 0.74606562 1.41166658
#&gt; [145] 1.16174198 1.68473194 0.78851340 2.01783105 1.42708858 1.47015281
#&gt; [151] 2.10720407 1.14206919 0.33621286 0.45141743 0.84264848 0.70291033
#&gt; [157] 1.97686832 0.99768548 1.62336656 1.05734949 1.77054664 1.46194903
#&gt; [163] 2.81871985 0.83773908 2.14802932 1.53614157 1.17693764 1.22117819
#&gt; [169] 2.04563901 1.16940962 1.11419515 0.54916306 1.88717877 1.81688291
#&gt; [175] 0.71464566 0.91777537 0.66772721 0.18361171 0.95945474 1.85536476
#&gt; [181] 0.52297458 0.11929514 1.27950445 0.90817703 0.53961152 0.25707838
#&gt; [187] 2.10519234 1.69839531 1.77494544 1.11367430 1.27474885 2.48717508
#&gt; [193] 1.14603600 1.16430043 2.13118210 1.33272736 1.26712767 0.49735248
#&gt; [199] 2.36505458 0.67321138
#&gt;  ... (250 hidden)
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>filtering</span>, asp <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='img'><img src='filter_outliers-2.svg' alt='' width='701' height='701' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.linkedin.com/in/adrienbrilhault/'>Adrien Brilhault</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '4dc1937e97dc79698b3bbb06638278be',
    indexName: 'adrienbrilhault',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


